{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
<div class="content">
    <p><strong>Suma:</strong> {{ total }}</p>

    <form method="get" style="margin: 16px 0;">
        <label style="margin-right: 12px;">
            Tryb:
            <select name="mode" onchange="this.form.submit()">
                <option value="day" {% if mode == "day" %}selected{% endif %}>Dzień</option>
                <option value="month" {% if mode == "month" %}selected{% endif %}>Miesiąc</option>
                <option value="year" {% if mode == "year" %}selected{% endif %}>Rok</option>
            </select>
        </label>

        <label style="margin-right: 12px;">
            Dzień:
            <input type="date" name="day" value="{{ day }}">
        </label>

        <label style="margin-right: 12px;">
            Miesiąc:
            <input type="month" name="month" value="{{ month }}">
        </label>

        <label style="margin-right: 12px;">
            Rok:
            <input type="number" name="year" value="{{ year }}" min="2000" max="2100" style="width: 90px;">
        </label>

        <button type="submit" class="button">Zastosuj</button>
    </form>

    <div style="max-width: 1100px;">
        <canvas id="pvChart" height="110"></canvas>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script>
  const labels = {{ chart_labels_json|safe }};
  const values = {{ chart_values_json|safe }};

  const ctx = document.getElementById('pvChart');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels,
      datasets: [{
        label: 'Odwiedziny',
        data: values,
        borderColor: '#fcc71f',
        backgroundColor: 'rgba(252,199,31,0.18)',
        fill: true,
        tension: 0.25,
        pointRadius: 2,
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { display: true },
      },
      scales: {
        y: { beginAtZero: true, ticks: { precision: 0 } }
      }
    }
  });
</script>
{% endblock %}


